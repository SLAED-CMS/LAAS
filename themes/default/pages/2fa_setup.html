{% extends "layout.html" %}

{% block content %}
<div class="card">
  <div class="card-body">
    <h1 class="h4 mb-3">{% t 'users.2fa.setup_title' %}</h1>
    <div id="page-messages">
      {% include "partials/messages.html" %}
    </div>

    {% if totp_enabled %}
      <div class="alert alert-success mb-3">
        {% t 'users.2fa.currently_enabled' %}
      </div>
      <p>{% t 'users.2fa.disable_instructions' %}</p>
      <form method="post" action="/2fa/disable">
        <div class="mb-3">
          <label class="form-label">
            {% t 'users.2fa.password_confirm' %}
          </label>
          <input class="form-control" type="password" name="password" autocomplete="current-password" required>
        </div>
        <input type="hidden" name="_token" value="{% csrf_token %}">
        <button class="btn btn-danger" type="submit">{% t 'users.2fa.disable_button' %}</button>
        <a href="/2fa/regenerate-backup-codes" class="btn btn-secondary">{% t 'users.2fa.regenerate_codes' %}</a>
      </form>
    {% else %}
      <p>{% t 'users.2fa.enable_description' %}</p>
      <form method="post" action="/2fa/enable">
        <input type="hidden" name="_token" value="{% csrf_token %}">
        <button class="btn btn-primary" type="submit">{% t 'users.2fa.enable_button' %}</button>
      </form>
    {% endif %}
  </div>
</div>
{% endblock %}
