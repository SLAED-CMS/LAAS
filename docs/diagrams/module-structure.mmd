graph TD
    %% LAAS CMS v3.0.0 - Module Architecture
    %% 9 modules: System, API, Admin, Users, Pages, Media, Menu, Changelog, DevTools
    %% Loading: Kernel scans modules/ -> reads config/modules.php -> includes routes.php
    %% Types: Core (required), Content (can disable), Admin (dev-only)
    %% Security: 2FA/TOTP, Password Reset, Session Timeout, SSRF Protection
    %% Frontend: AssetManager, UI Tokens, ViewModels, Theme API v1
    %% Version: v3.0.0 (2026-01-12)

    subgraph Core["Core Framework"]
        Kernel["Kernel<br/>Bootstrap & DI Container"]
        Router["Router<br/>FastRoute"]
        Middleware["Middleware Pipeline<br/>7 middlewares"]
        View["View<br/>Template Engine"]
        DB["Database<br/>PDO Connection Pool"]
    end

    subgraph Modules["9 Installed Modules"]
        System["System Module<br/>Health, Backup, Audit"]
        API["API Module<br/>REST API v1 + Bearer Tokens"]
        Admin["Admin Module<br/>Backend UI"]
        Users["Users Module<br/>Auth, RBAC, 2FA, Password Reset (v3.0.0)"]
        Pages["Pages Module<br/>CMS Content"]
        Media["Media Module<br/>File Management"]
        Menu["Menu Module<br/>Navigation"]
        Changelog["Changelog Module<br/>Git-based (GitHub/local)"]
        DevTools["DevTools Module<br/>Debug Tools"]
    end

    subgraph ModuleStructure["Module Structure (Example: Media)"]
        Routes["routes.php<br/>GET /media, POST /media/upload"]
        Controllers["Controllers/<br/>MediaController.php"]
        Repos["Repositories/<br/>MediaRepository.php"]
        Migrations["Migrations/<br/>001_create_media_table.sql"]
        Translations["Translations/<br/>de.php, en.php"]
    end

    Kernel --> Modules
    Router --> Modules
    Middleware --> Modules
    Modules --> DB
    Modules --> View

    Media -.-> Routes
    Media -.-> Controllers
    Media -.-> Repos
    Media -.-> Migrations
    Media -.-> Translations

    style Kernel fill:#ff6b6b
    style Router fill:#4ecdc4
    style Middleware fill:#ffe66d
    style View fill:#95e1d3
    style DB fill:#a8e6cf

    style System fill:#c7ceea
    style API fill:#ffd3b6
    style Admin fill:#ffaaa5
    style Users fill:#a8e6cf
    style Pages fill:#95e1d3
    style Media fill:#4ecdc4
    style Menu fill:#ffe66d
    style Changelog fill:#ff9ff3
    style DevTools fill:#ff6b6b

    %% Notes
    Note1["Module Loading:<br/>1. Kernel scans modules/ directory<br/>2. Loads routes.php from each module<br/>3. Registers in DI Container<br/>4. Runs migrations on install"]
    Note2["Module Types:<br/>Core: System, API, Users<br/>Content: Pages, Media, Menu<br/>Admin: Admin, DevTools"]