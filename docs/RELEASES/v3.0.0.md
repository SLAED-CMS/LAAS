# Release v3.0.0 (Stable)

## Highlights
- Headless mode with HTML allowlist and JSON-first behavior
- Contract envelope + registry + fixtures guard
- Policy checks and preflight CLI for release readiness

## Breaking changes
- None

## Upgrade steps
- See `UPGRADING.md`
- `git pull`
- `composer install --no-dev`
- `php tools/cli.php preflight --no-tests`
- `php tools/cli.php migrate:up` (if required)

## Supported contracts

| contract_name | route | method | notes |
| --- | --- | --- | --- |
| pages.show | /{slug} | GET | 200 ok, 404 not_found |
| admin.modules.index | /admin/modules | GET | 200 ok, 403 forbidden |
| admin.modules.toggle | /admin/modules/toggle | POST | 200 ok, 400 protected_module |
| admin.settings.index | /admin/settings | GET | 200 ok, 403 forbidden |
| admin.settings.save | /admin/settings | POST | 200 ok, 422 validation_failed |
| admin.users.index | /admin/users | GET | 200 ok, 403 forbidden |
| admin.users.toggle | /admin/users/status | POST | 200 ok, 422 validation_failed, 403 forbidden |
| admin.media.index | /admin/media | GET | 200 ok, 403 forbidden |
| admin.media.upload | /admin/media/upload | POST | 201 ok, 400 invalid_mime, 413 file_too_large, 422 validation_failed, 403 forbidden |
| media.show | /media/{id} | GET | 200 ok, 404 not_found, 403 forbidden |

## Headless mode rules
- Enable via `APP_HEADLESS=true`
- Default response is JSON envelope
- HTML only when `Accept: text/html` and allowlisted
- Force JSON via `Accept: application/json` or `?format=json`

## How to validate
- `php tools/cli.php preflight --no-db`
